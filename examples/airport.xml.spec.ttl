@prefix : <http://example.com/schema/data_conversion#> .
@prefix bibo: <http://purl.org/ontology/bibo/> .
@prefix fly: <http://vocab.org/fly/schema/> .
@prefix foaf: <http://xmlns.com/foaf/0.1/> .
@prefix geo: <http://www.w3.org/2003/01/geo/wgs84_pos#> .
@prefix georss: <http://www.georss.org/georss/> .
@prefix naptan: <http://transport.data.gov.uk/def/naptan/> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix places: <http://purl.org/ontology/places#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix spacerel: <http://data.ordnancesurvey.co.uk/ontology/spatialrelations/> .
@prefix transit: <http://vocab.org/transit/terms/> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix ex: <http://data.example.com#> .

<#> a :Spec;
:resource <#airport>, <#airport_type>, <#municipality>, <#country>, <#continent>, <#region>, <#boolean_lookup>, <#ourairports_page>;
:base_uri "http://data.example.com/airports/" .

<#airport> a :Resource
; :identity [ :source_column "airport_ident"; ]
; :type fly:Airport, transit:Stop, naptan:Airport
; :relationship
	[ :property rdf:type; :object_from <#airport_type> ],
	[ :property spacerel:within; :object_from <#municipality> ],
	[ :property spacerel:within; :object_from <#region> ],
	[ :property spacerel:within; :object_from <#country> ],
	[ :property spacerel:within; :object_from <#continent> ],
	[ :property foaf:isPrimaryTopicOf; :object_from <#ourairports_page> ]
        
; :attribute
	[ :property geo:lat; :source_column "airport_latitude_deg"; :datatype xsd:float ],
	[ :property geo:long; :source_column "airport_longitude_deg"; :datatype xsd:float ],
	[ :property foaf:name; :source_column "airport_name"; :language "en" ],
	[ :property fly:icao_code; :source_column "airport_ident" ],
	[ :property fly:scheduled_service; :source_column "airport_scheduled_service"; :lookup <#boolean_lookup> ]
.

<#airport_type> a :Resource
; :identity [
	:source_column "airport_type";
	:process ( :normalise :title_case )
; :base_uri "http://data.example.com/airports/schema/" ]
; :type rdfs:Class

; :attribute[
	:property rdfs:label;
	:source_column "type";
	:process ( :regex :title_case );
	:regex_match "_";
	:regex_output " ";
].

<#continent> a :Resource
; :type ex:continent
; :identity [
	:source_column "airport_continent";
	:base_uri "http://data.example.com/world-geography/continents/"
].

<#country> a :Resource;
    :type ex:country;
    :identity [
        :source_column "airport_iso_country";
        :base_uri "http://data.example.com/world-geography/countries/"
    ].
    
<#region> a :Resource;
    :type places:Region;
    :identity [
        :source_column "airport_iso_region";
        :base_uri "http://data.example.com/world-geography/regions/"
    ].
    
<#municipality> a :Resource;
    :type places:Municipality;
    :identity [
        :source_column "airport_municipality";
        :container "municipalities";
        :process ( :flatten_utf8 :normalise );
	];
    :relationship [
        :property spacerel:within;
        :object_from <#region>
    ];
    :attribute [
        :property rdfs:label;
        :source_column "airport_municipality"
    ] .     

<#ourairports_page> a :Resource;
    :type bibo:Webpage;
    :identity [
        :source_column "airport_ident";
        :base_uri "";
        :process ( :regex );
        :regex_match "^(.*)$";
        :regex_output "http://www.ourairports.com/airports/${1}/";
	] . 
    
<#boolean_lookup> a :Lookup; 
  :lookup_entry [ 
    :lookup_key "yes"; 
    :lookup_value "true"^^xsd:boolean 
  ]; 
  :lookup_entry [ 
    :lookup_key "true"; 
    :lookup_value "true"^^xsd:boolean 
  ]; 
  :lookup_entry [ 
    :lookup_key "no"; 
    :lookup_value "false"^^xsd:boolean 
  ]; 
  :lookup_entry [ 
    :lookup_key "false"; 
    :lookup_value "false"^^xsd:boolean 
  ] .    